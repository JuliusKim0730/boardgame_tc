# 찬스 카드 상세 구현 명세

## 💰 돈 카드 (CH1~CH7)

### CH1: 아빠가 기분 좋아서! (+3,000TC)
- **동작**: 뽑는 즉시 +3,000TC 자동 적용
- **구현**: ✅ 완료

### CH2: 여행 지원금 당첨! (+4,000TC)
- **동작**: 뽑는 즉시 +4,000TC 자동 적용
- **구현**: ✅ 완료

### CH3~CH7: 돈 잃기 (-1,000TC)
- **동작**: 뽑는 즉시 -1,000TC 자동 적용
- **구현**: ✅ 완료

---

## 🤝 상호작용 카드

### CH8: 친구와 집안일
**플로우**:
1. 카드 뽑음
2. 플레이어 선택 모달 표시 (자신 제외)
3. 플레이어 1명 선택
4. 확인 버튼 클릭
5. 나와 선택한 플레이어가 집안일 카드 1장씩 드로우
6. 각 카드 효과 즉시 적용 (TC 지급)

**구현 상태**: 🔧 수정 필요
- 현재: 집안일 카드 2장 드로우 (요청자, 대상자 각 1장)
- 수정: 효과 즉시 적용 확인

---

### CH9: 공동 지원 이벤트
**플로우**:
1. 카드 뽑음
2. 플레이어 선택 모달 표시 (자신 제외)
3. 플레이어 1명 선택
4. 확인 버튼 클릭
5. 구매 확인 모달 표시:
   - "1,000 TC를 지불해서 계획카드 구매할까요?"
   - 보유 TC < 1,000: 구매 버튼 비활성화
   - 보유 TC ≥ 1,000: 구매 버튼 활성화
6. 구매 버튼 클릭:
   - 1,000TC 소비
   - 계획 카드 1장 드로우
   - 손패에 추가

**구현 상태**: 🔧 수정 필요
- 현재: 각자 1,000TC 지불 후 계획 카드 2장 드로우
- 수정: 요청자만 선택적으로 구매

---

### CH10: 계획 구매 요청
**플로우**:
1. 카드 뽑음
2. 플레이어 선택 모달 표시 (자신 제외)
3. 플레이어 1명 선택
4. 확인 버튼 클릭
5. 조건 확인:
   - 내 TC < 1,000: 무효 처리 → 턴 종료
   - 내 TC ≥ 1,000: 계속
6. 대상의 계획 카드 중 임의로 1장 선택
7. 1,000TC를 대상에게 지불
8. 선택된 카드를 내 손패로 이동

**구현 상태**: 🔧 수정 필요
- 현재: 대상이 수락/거절 선택
- 수정: 즉시 실행 (강제 구매)

---

### CH11: 계획 교환
**플로우**:
1. 카드 뽑음
2. 플레이어 선택 모달 표시 (계획 카드 보유자만)
3. 플레이어 1명 선택
4. 내 계획 카드 중 1장 선택
5. 대상의 계획 카드 중 1장 선택 (대상이 선택)
6. 카드 교환
7. 예외 처리:
   - 모든 플레이어가 계획 카드 0장: 포기 버튼 표시
   - 포기 클릭: 무효 처리 → 턴 종료

**구현 상태**: 🔧 수정 필요
- 양방향 선택 UI 필요

---

### CH12: 모두 내 자리로
**플로우**:
1. 카드 뽑음
2. 즉시 실행: 모든 플레이어를 내 위치로 강제 이동
3. 강제 이동 플래그 설정 (연속 사용 금지 예외)

**구현 상태**: ✅ 완료

---

### CH13: 자리 바꾸기
**플로우**:
1. 카드 뽑음
2. 플레이어 선택 모달 표시 (자신 제외)
3. 플레이어 1명 선택
4. 확인 버튼 클릭
5. 위치 교환
6. **추가 행동**: 카드를 뽑은 플레이어가 새 위치에서 행동 1회 수행

**구현 상태**: 🔧 수정 필요
- 추가 행동 구현 필요

---

## 🎴 드로우 카드

### CH14: 여행 이야기 듣기
**플로우**:
1. 카드 뽑음
2. 전체 플레이어의 계획 카드 개수 확인
3. 가장 적은 플레이어 찾기
4. 해당 플레이어(들)에게 계획 카드 1장씩 지급
5. 동점자 처리: 모두에게 1장씩 지급

**구현 상태**: ✅ 완료

---

### CH15: 좋은 정보 발견
**플로우**:
1. 카드 뽑음
2. 즉시 계획 카드 1장 드로우
3. 손패에 추가

**구현 상태**: ✅ 완료

---

### CH16: 버린만큼 뽑기
**플로우**:
1. 카드 뽑음
2. 내 손패 표시 (무료계획 + 계획 카드)
3. 버릴 카드 선택 (복수 선택 가능)
4. 확인 버튼 클릭
5. 선택한 카드 버림 (discarded_cards 테이블)
6. 버린 카드 수만큼 계획 카드 드로우
7. 손패에 추가

**구현 상태**: 🔧 구현 필요

---

### CH17: 여행 팜플렛
**플로우**:
1. 카드 뽑음
2. 기존 공동 목표 카드 제거
3. 공동 목표 카드 목록 표시 (JP1~JP10)
4. 새로운 공동 목표 카드 1장 선택
5. 선택한 카드를 공동 목표로 설정
6. 기여 금액 초기화 (선택사항)

**구현 상태**: 🔧 수정 필요
- 현재: 선택 모달만 구현
- 수정: 기존 카드 제거 로직 추가

---

## ⚡ 특수 행동 카드

### CH18: 체력이 넘친다!
**플로우**:
1. 카드 뽑음
2. 행동 선택 모달 표시 (1~6번)
3. 행동 1개 선택
4. 확인 버튼 클릭
5. 이동 없이 선택한 행동 수행

**구현 상태**: ✅ 완료

---

### CH19: 반전의 기회
**플로우**:
1. 카드 뽑음
2. 즉시 찬스 카드 1장 더 드로우
3. 새로 뽑은 찬스 카드 효과 실행

**구현 상태**: 🔧 수정 필요
- 현재: 현재 칸에서 행동 1회 더
- 수정: 찬스 카드 1장 더 뽑기

---

### CH20: 공동 목표 지원
**플로우**:
1. 카드 뽑음
2. 즉시 1,000TC를 공동 목표에 기여
3. 자동 처리 (모달 없음)

**구현 상태**: ✅ 완료

---

## 🎯 캐치업 카드

### CH21: 엄마의 응원
**플로우**:
1. 카드 뽑음
2. 전체 플레이어의 TC 확인
3. 가장 적은 플레이어 찾기
4. 해당 플레이어(들)에게 +2,000TC 지급
5. 동점자 처리: 모두에게 지급

**구현 상태**: ✅ 완료

---

### CH22: 여행 선생님의 조언
**플로우**:
1. 카드 뽑음
2. 전체 플레이어의 계획 카드 개수 확인
3. 가장 적은 플레이어 찾기
4. 해당 플레이어(들)에게 계획 카드 1장씩 지급
5. 동점자 처리: 모두에게 1장씩 지급

**구현 상태**: ✅ 완료 (CH14와 동일)

---

### CH23: 가족 사진 대작전
**플로우**:
1. 카드 뽑음
2. 전체 플레이어의 추억 점수 확인
3. 가장 낮은 플레이어 찾기
4. 해당 플레이어(들)에게 추억 +2점 지급
5. 동점자 처리: 모두에게 지급

**구현 상태**: ✅ 완료

---

### CH24: 엄마의 응원 메시지
**플로우**: CH23과 동일

**구현 상태**: ✅ 완료

---

### CH25: 동행 버디
**플로우**:
1. 카드 뽑음
2. 플레이어 선택 모달 표시 (자신 제외)
3. 플레이어 1명 선택
4. 확인 버튼 클릭
5. 나: 추가 행동 1회 수행
6. 선택한 플레이어: 추가 행동 1회 수행

**구현 상태**: ✅ 완료

---

## 🔧 구현 우선순위

### 🔴 긴급 (기능 변경)
1. **CH9**: 구매 확인 모달 추가
2. **CH10**: 강제 구매로 변경
3. **CH13**: 추가 행동 구현
4. **CH19**: 찬스 카드 1장 더 뽑기로 변경

### 🟡 중요 (신규 구현)
5. **CH16**: 버린만큼 뽑기 구현
6. **CH11**: 양방향 카드 교환 UI

### 🟢 개선
7. **CH17**: 기존 카드 제거 로직
8. **CH8**: 효과 적용 확인

---

## 📋 구현 체크리스트

- [x] CH1~CH7: 돈 카드 즉시 적용
- [x] CH8: 집안일 카드 드로우
- [ ] CH9: 구매 확인 모달 (수정 필요)
- [ ] CH10: 강제 구매 (수정 필요)
- [ ] CH11: 양방향 교환 (구현 필요)
- [x] CH12: 모두 내 자리로
- [ ] CH13: 추가 행동 (수정 필요)
- [x] CH14: 계획 카드 캐치업
- [x] CH15: 계획 카드 드로우
- [ ] CH16: 버린만큼 뽑기 (구현 필요)
- [ ] CH17: 공동 목표 선택 (수정 필요)
- [x] CH18: 추가 행동
- [ ] CH19: 찬스 카드 더 뽑기 (수정 필요)
- [x] CH20: 공동 목표 지원
- [x] CH21: TC 캐치업
- [x] CH22: 계획 카드 캐치업
- [x] CH23: 추억 캐치업
- [x] CH24: 추억 캐치업
- [x] CH25: 동행 버디

---

**작성일**: 2024-12-07
**버전**: v1.0
