# 찬스 카드 검증 보고서

## 찬스 카드 전체 목록 (26장)

### 1. 돈 카드 (7장)

#### ✅ CH1: 아빠가 기분 좋아서! (+3,000TC)
- **타입**: money
- **효과**: +3,000TC
- **구현 상태**: ✅ 구현됨 (`handleMoneyCard`)
- **검증 필요**: 돈이 실제로 증가하는지 확인

#### ✅ CH2: 여행 지원금 당첨! (+4,000TC)
- **타입**: money
- **효과**: +4,000TC
- **구현 상태**: ✅ 구현됨 (`handleMoneyCard`)
- **검증 필요**: 돈이 실제로 증가하는지 확인

#### ✅ CH3: 준비물 구매 (-1,000TC)
- **타입**: money
- **효과**: -1,000TC
- **구현 상태**: ✅ 구현됨 (`handleMoneyCard`)
- **검증 필요**: 돈이 실제로 감소하는지 확인

#### ✅ CH4: 간식 충동구매 (-1,000TC)
- **타입**: money
- **효과**: -1,000TC
- **구현 상태**: ✅ 구현됨 (`handleMoneyCard`)

#### ✅ CH5: 우산 잃어버림 (-1,000TC)
- **타입**: money
- **효과**: -1,000TC
- **구현 상태**: ✅ 구현됨 (`handleMoneyCard`)

#### ✅ CH6: 충전기 구매 (-1,000TC)
- **타입**: money
- **효과**: -1,000TC
- **구현 상태**: ✅ 구현됨 (`handleMoneyCard`)

#### ✅ CH7: 버스카드 충전 (-1,000TC)
- **타입**: money
- **효과**: -1,000TC
- **구현 상태**: ✅ 구현됨 (`handleMoneyCard`)

---

### 2. 상호작용 카드 (6장)

#### ✅ CH8: 친구와 집안일
- **타입**: interaction
- **액션**: shared_house
- **효과**: 대상 선택 → 집안일 카드 1장 뽑기 → 두 플레이어 모두 수익 획득
- **구현 상태**: ✅ 구현됨 (`handleSharedHouse`, `executeSharedHouse`)
- **검증 필요**: 
  - 대상 선택 모달 표시
  - 집안일 카드 드로우
  - 두 플레이어 모두 돈 증가

#### ✅ CH9: 공동 지원 이벤트
- **타입**: interaction
- **액션**: shared_invest
- **효과**: 대상 선택 → 여행지원 카드 1장 뽑기 → 두 플레이어 모두 효과 적용
- **구현 상태**: ✅ 구현됨 (`handleSharedInvest`, `executeSharedInvest`)
- **검증 필요**:
  - 대상 선택 모달 표시
  - 여행지원 카드 드로우
  - 두 플레이어 모두 효과 적용

#### ✅ CH10: 계획 구매 요청
- **타입**: interaction
- **액션**: purchase_request
- **효과**: 대상 선택 → 1,000TC에 계획 카드 구매 제안 → 수락 시 거래 성사
- **구현 상태**: ✅ 구현됨 (`handlePurchaseRequest`, `executePurchase`)
- **검증 필요**:
  - 대상 선택 및 카드 선택 모달
  - 수락/거절 처리
  - 돈 이동 및 카드 소유권 이전

#### ⚠️ CH11: 계획 교환 (2인 금지)
- **타입**: interaction
- **액션**: card_exchange
- **효과**: 대상 선택 → 서로 계획 카드 1장씩 교환
- **구현 상태**: ✅ 구현됨 (`handleCardExchange`, `executeCardExchange`)
- **2인 금지**: ✅ 구현됨 (`forbidden_2p` 체크)
- **검증 필요**:
  - 2인 플레이 시 사용 불가 확인
  - 카드 교환 모달
  - 카드 소유권 교환

#### ⚠️ CH12: 모두 내 자리로 (2인 금지)
- **타입**: interaction
- **액션**: summon_all
- **효과**: 모든 플레이어를 내 위치로 이동
- **구현 상태**: ✅ 구현됨 (`handleSummonAll`)
- **2인 금지**: ✅ 구현됨 (`forbidden_2p` 체크)
- **검증 필요**:
  - 2인 플레이 시 사용 불가 확인
  - 모든 플레이어 위치 변경
  - forced_move 플래그 설정

#### ⚠️ CH13: 자리 바꾸기 (2인 금지)
- **타입**: interaction
- **액션**: swap_position
- **효과**: 대상 선택 → 위치 교환
- **구현 상태**: ✅ 구현됨 (`handleSwapPosition`, `executeSwapPosition`)
- **2인 금지**: ✅ 구현됨 (`forbidden_2p` 체크)
- **검증 필요**:
  - 2인 플레이 시 사용 불가 확인
  - 위치 교환
  - forced_move 플래그 설정

---

### 3. 드로우 카드 (4장)

#### ✅ CH14: 여행 이야기 듣기
- **타입**: draw
- **액션**: catchup_plan
- **효과**: 계획 카드가 가장 적은 플레이어에게 계획 카드 1장 지급
- **구현 상태**: ✅ 구현됨 (`drawPlanForLowest`)
- **검증 필요**:
  - 계획 카드 최저 플레이어 찾기
  - 해당 플레이어에게 카드 지급
  - 메시지 표시

#### ✅ CH15: 좋은 정보 발견
- **타입**: draw
- **액션**: draw_plan
- **효과**: 계획 카드 1장 드로우
- **구현 상태**: ✅ 구현됨 (`drawPlan`)
- **검증 필요**:
  - 계획 카드 1장 획득
  - 손패에 추가

#### ✅ CH16: 버린만큼 뽑기
- **타입**: special
- **액션**: draw_discarded
- **효과**: 버린 카드 수만큼 계획 카드 드로우
- **구현 상태**: ✅ 구현됨 (`handleDrawDiscarded`)
- **검증 필요**:
  - 버린 카드 수 계산
  - 해당 수만큼 계획 카드 드로우
  - 손패에 추가

#### ⚠️ CH17: 여행 팜플렛
- **타입**: special
- **액션**: select_joint_plan
- **효과**: 공동 목표 카드 선택
- **구현 상태**: ✅ 구현됨 (`handleSelectJointPlan`)
- **검증 필요**:
  - 공동 목표 카드 선택 모달
  - 선택한 카드가 공동 목표로 설정
  - **주의**: 프론트엔드 모달 구현 필요

---

### 4. 특수 행동 카드 (3장)

#### ⚠️ CH18: 체력이 넘친다!
- **타입**: special
- **액션**: extra_action
- **효과**: 이동 없이 행동 1회
- **구현 상태**: ⚠️ 부분 구현 (메시지만 반환)
- **검증 필요**:
  - 프론트엔드에서 추가 행동 처리
  - 이동 없이 행동 가능 확인

#### ⚠️ CH19: 반전의 기회
- **타입**: special
- **액션**: repeat_current
- **효과**: 이동 없이 현재 칸 행동 1회 추가
- **구현 상태**: ✅ 구현됨 (`handleRepeatCurrentAction`)
- **검증 필요**:
  - 현재 위치에서 행동 반복
  - 프론트엔드에서 추가 행동 처리

#### ✅ CH20: 공동 목표 지원
- **타입**: special
- **액션**: joint_plan_support
- **효과**: 공동 목표에 3,000TC 기여
- **구현 상태**: ✅ 구현됨 (`handleJointPlanSupport`)
- **검증 필요**:
  - 공동 목표 기여 테이블에 3,000TC 추가
  - 메시지 표시

---

### 5. 캐치업 카드 (5장)

#### ✅ CH21: 엄마의 응원
- **타입**: catchup
- **액션**: catchup_money
- **효과**: TC가 가장 적은 플레이어에게 +2,000TC
- **구현 상태**: ✅ 구현됨 (`catchupMoney`)
- **검증 필요**:
  - TC 최저 플레이어 찾기
  - 2,000TC 지급
  - 메시지 표시

#### ✅ CH22: 여행 선생님의 조언
- **타입**: catchup
- **액션**: catchup_plan
- **효과**: 일반 계획 가장 적은 플레이어에게 계획 카드 1장
- **구현 상태**: ✅ 구현됨 (`drawPlanForLowest`)
- **검증 필요**:
  - 계획 카드 최저 플레이어 찾기
  - 계획 카드 1장 지급

#### ✅ CH23: 가족 사진 대작전
- **타입**: catchup
- **액션**: catchup_memory
- **효과**: 추억이 가장 낮은 플레이어에게 추억 +2
- **구현 상태**: ✅ 구현됨 (`catchupMemory`)
- **검증 필요**:
  - 추억 최저 플레이어 찾기
  - 추억 +2 적용
  - 메시지 표시

#### ✅ CH24: 엄마의 응원 메시지
- **타입**: catchup
- **액션**: catchup_memory
- **효과**: 추억이 가장 낮은 플레이어에게 추억 +2
- **구현 상태**: ✅ 구현됨 (`catchupMemory`)
- **검증 필요**: CH23과 동일

#### ⚠️ CH25: 동행 버디
- **타입**: catchup
- **액션**: buddy_action
- **효과**: 본인 행동 1회 + 지목한 플레이어 행동 1회
- **구현 상태**: ⚠️ 부분 구현 (`handleBuddyAction`, `executeBuddyAction`)
- **검증 필요**:
  - 대상 선택 모달
  - 두 플레이어 모두 추가 행동 가능
  - **주의**: 프론트엔드에서 추가 행동 처리 필요

---

## 구현 상태 요약

### ✅ 완전 구현 (20장)
- 돈 카드 7장 (CH1-CH7)
- 상호작용 카드 6장 (CH8-CH13)
- 드로우 카드 3장 (CH14-CH16)
- 특수 행동 1장 (CH20)
- 캐치업 카드 3장 (CH21-CH24)

### ⚠️ 부분 구현 (프론트엔드 처리 필요) (3장)
- CH17: 여행 팜플렛 (공동 목표 선택 모달 필요)
- CH18: 체력이 넘친다! (추가 행동 처리 필요)
- CH19: 반전의 기회 (추가 행동 처리 필요)
- CH25: 동행 버디 (추가 행동 처리 필요)

---

## 검증 필요 사항

### 1. 돈 증감 효과 (CH1-CH7, CH20, CH21)
- [ ] 돈이 정확히 증가/감소하는지 확인
- [ ] 업데이트 후 잔액 표시 확인
- [ ] 음수 방지 (0 이하로 떨어지지 않도록)

### 2. 상호작용 카드 (CH8-CH13)
- [ ] 대상 선택 모달 표시 확인
- [ ] 2인 금지 카드 (CH11-CH13) 2인 플레이 시 사용 불가 확인
- [ ] 카드 교환/구매 시 소유권 이전 확인
- [ ] 위치 이동 시 forced_move 플래그 확인

### 3. 드로우 카드 (CH14-CH16)
- [ ] 계획 카드가 손패에 추가되는지 확인
- [ ] 버린 카드 수 계산 정확성 확인
- [ ] 덱이 비었을 때 처리 확인

### 4. 특수 행동 카드 (CH17-CH20)
- [ ] CH17: 공동 목표 선택 모달 구현 필요
- [ ] CH18, CH19: 추가 행동 처리 구현 필요
- [ ] CH20: 공동 목표 기여 확인

### 5. 캐치업 카드 (CH21-CH25)
- [ ] 최저 플레이어 찾기 로직 확인
- [ ] CH25: 동행 버디 추가 행동 처리 구현 필요

---

## 테스트 시나리오

### 시나리오 1: 돈 카드 테스트
1. CH1 (아빠가 기분 좋아서!) 획득
2. 현재 돈: 3,000TC → 6,000TC 확인
3. CH3 (준비물 구매) 획득
4. 현재 돈: 6,000TC → 5,000TC 확인

### 시나리오 2: 상호작용 카드 테스트
1. CH8 (친구와 집안일) 획득
2. 대상 선택 모달 표시 확인
3. 대상 선택 후 집안일 카드 드로우 확인
4. 두 플레이어 모두 돈 증가 확인

### 시나리오 3: 드로우 카드 테스트
1. CH15 (좋은 정보 발견) 획득
2. 계획 카드 1장 손패에 추가 확인
3. CH16 (버린만큼 뽑기) 획득
4. 버린 카드 수만큼 계획 카드 획득 확인

### 시나리오 4: 캐치업 카드 테스트
1. CH21 (엄마의 응원) 획득
2. TC 최저 플레이어 찾기 확인
3. 해당 플레이어에게 2,000TC 지급 확인

---

## 수정 필요 사항

### 1. CH20 공동 목표 지원 수정 필요
현재 코드:
```typescript
await client.query(
  'INSERT INTO joint_plan_contributions (game_id, player_state_id, amount) VALUES ($1, (SELECT id FROM player_states WHERE game_id = $1 AND player_id = $2), 3000)',
  [gameId, playerId]
);
```

**문제**: `effects`에 `money: 3000`이 있지만 실제로는 기여만 하고 돈을 차감하지 않음

**수정 필요**: 플레이어 돈에서 3,000TC 차감 후 기여

### 2. CH17, CH18, CH19, CH25 프론트엔드 처리 필요
- 공동 목표 선택 모달 구현
- 추가 행동 처리 로직 구현
- 동행 버디 추가 행동 처리 구현

