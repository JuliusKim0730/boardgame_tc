# í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¡°

## ì „ì²´ êµ¬ì¡°

```
frontend/src/
â”œâ”€â”€ main.tsx                    # ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
â”œâ”€â”€ App.tsx                     # ë©”ì¸ ì•± (ë¼ìš°íŒ…)
â”œâ”€â”€ components/                 # React ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ LobbyScreen.tsx        # ë¡œë¹„ (ë°© ìƒì„±/ì°¸ì—¬)
â”‚   â”œâ”€â”€ WaitingRoom.tsx        # ëŒ€ê¸°ì‹¤
â”‚   â”œâ”€â”€ GameScreen.tsx         # ê²Œì„ ë©”ì¸ í™”ë©´
â”‚   â”œâ”€â”€ GameBoard.tsx          # ê²Œì„ ë³´ë“œ (6ì¹¸)
â”‚   â”œâ”€â”€ PlayerInfo.tsx         # í”Œë ˆì´ì–´ ì •ë³´
â”‚   â”œâ”€â”€ HandCards.tsx          # ì†íŒ¨ ì¹´ë“œ
â”‚   â”œâ”€â”€ ActionLog.tsx          # í–‰ë™ ë¡œê·¸
â”‚   â”œâ”€â”€ ResultScreen.tsx       # ê²°ê³¼ í™”ë©´
â”‚   â”œâ”€â”€ CardDrawModal.tsx      # ì¹´ë“œ ë“œë¡œìš° ëª¨ë‹¬
â”‚   â”œâ”€â”€ ChanceModal.tsx        # ì°¬ìŠ¤ ì„ íƒ ëª¨ë‹¬
â”‚   â”œâ”€â”€ ContributeModal.tsx    # ê³µë™ ê³„íš ê¸°ì—¬ ëª¨ë‹¬
â”‚   â””â”€â”€ TraitConversionModal.tsx # íŠ¹ì„± ë³€í™˜ ëª¨ë‹¬
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ api.ts                 # REST API í´ë¼ì´ì–¸íŠ¸
â”‚   â””â”€â”€ socket.ts              # Socket.io í´ë¼ì´ì–¸íŠ¸
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ storage.ts             # localStorage ìœ í‹¸
â””â”€â”€ *.css                      # ì»´í¬ë„ŒíŠ¸ë³„ ìŠ¤íƒ€ì¼
```

## ì£¼ìš” ì»´í¬ë„ŒíŠ¸

### 1. App.tsx (ë©”ì¸ ì•±)

**ì±…ì„**: í™”ë©´ ì „í™˜ ê´€ë¦¬

```typescript
function App() {
  const [screen, setScreen] = useState<'lobby' | 'waiting' | 'game'>('lobby');
  const [roomId, setRoomId] = useState<string>('');
  const [gameId, setGameId] = useState<string>('');
  const [playerId, setPlayerId] = useState<string>('');
  const [userId, setUserId] = useState<string>('');

  return (
    <div className="app">
      {screen === 'lobby' && (
        <LobbyScreen onJoinRoom={handleJoinRoom} />
      )}
      {screen === 'waiting' && (
        <WaitingRoom
          roomId={roomId}
          playerId={playerId}
          onGameStart={handleGameStart}
          onBackToLobby={handleBackToLobby}
        />
      )}
      {screen === 'game' && (
        <GameScreen
          roomId={roomId}
          gameId={gameId}
          playerId={playerId}
          userId={userId}
          onBackToLobby={handleBackToLobby}
        />
      )}
    </div>
  );
}
```

### 2. LobbyScreen.tsx (ë¡œë¹„)

**ê¸°ëŠ¥**:
- ë°© ìƒì„±
- ë°© ì°¸ì—¬ (4ìë¦¬ ì½”ë“œ ì…ë ¥)
- ë‹‰ë„¤ì„ ì…ë ¥

```typescript
function LobbyScreen({ onJoinRoom }: Props) {
  const [nickname, setNickname] = useState('');
  const [roomCode, setRoomCode] = useState('');
  const [mode, setMode] = useState<'create' | 'join'>('create');

  const handleCreateRoom = async () => {
    const response = await api.createRoom(nickname);
    onJoinRoom(response.data);
  };

  const handleJoinRoom = async () => {
    const response = await api.joinRoom(roomCode, nickname);
    onJoinRoom(response.data);
  };

  return (
    <div className="lobby-screen">
      <h1>ğŸŒ™ ì—´ë„¤ ë°¤ì˜ ê¿ˆ</h1>
      <input
        type="text"
        placeholder="ë‹‰ë„¤ì„"
        value={nickname}
        onChange={(e) => setNickname(e.target.value)}
      />
      {mode === 'create' ? (
        <button onClick={handleCreateRoom}>ë°© ë§Œë“¤ê¸°</button>
      ) : (
        <>
          <input
            type="text"
            placeholder="ë°© ì½”ë“œ (4ìë¦¬)"
            value={roomCode}
            onChange={(e) => setRoomCode(e.target.value.toUpperCase())}
            maxLength={4}
          />
          <button onClick={handleJoinRoom}>ì°¸ì—¬í•˜ê¸°</button>
        </>
      )}
    </div>
  );
}
```

### 3. WaitingRoom.tsx (ëŒ€ê¸°ì‹¤)

**ê¸°ëŠ¥**:
- í”Œë ˆì´ì–´ ëª©ë¡ í‘œì‹œ
- ë°©ì¥ í‘œì‹œ
- ê²Œì„ ì‹œì‘ ë²„íŠ¼ (ë°©ì¥ë§Œ)
- ë°© ì½”ë“œ í‘œì‹œ

```typescript
function WaitingRoom({ roomId, playerId, onGameStart, onBackToLobby }: Props) {
  const [room, setRoom] = useState<Room | null>(null);
  const [players, setPlayers] = useState<Player[]>([]);

  useEffect(() => {
    loadRoom();
    const socket = socketService.connect(roomId);
    
    socket.on('player-joined', () => loadRoom());
    socket.on('player-left', () => loadRoom());
    socket.on('game-started', (data) => onGameStart(data.gameId));
    
    return () => socketService.disconnect();
  }, [roomId]);

  const handleStartGame = async () => {
    await api.startGame(roomId);
  };

  const isHost = players[0]?.id === playerId;

  return (
    <div className="waiting-room">
      <h2>ëŒ€ê¸°ì‹¤</h2>
      <div className="room-code">ë°© ì½”ë“œ: {room?.code}</div>
      <div className="players-list">
        {players.map((player, index) => (
          <div key={player.id} className="player-item">
            {index === 0 && 'ğŸ‘‘ '}
            {player.nickname}
          </div>
        ))}
      </div>
      {isHost && (
        <button onClick={handleStartGame}>ê²Œì„ ì‹œì‘</button>
      )}
      <button onClick={onBackToLobby}>ë‚˜ê°€ê¸°</button>
    </div>
  );
}
```

### 4. GameScreen.tsx (ê²Œì„ ë©”ì¸)

**ê¸°ëŠ¥**:
- ê²Œì„ ìƒíƒœ ê´€ë¦¬
- í„´ ê´€ë¦¬
- ì´ë™/í–‰ë™ ì²˜ë¦¬
- WebSocket ì´ë²¤íŠ¸ ìˆ˜ì‹ 

```typescript
function GameScreen({ roomId, gameId, playerId, onBackToLobby }: Props) {
  const [gameState, setGameState] = useState<GameState>({...});
  const [playerState, setPlayerState] = useState<PlayerState | null>(null);
  const [allPlayers, setAllPlayers] = useState<Player[]>([]);
  const [hasMoved, setHasMoved] = useState(false);
  const [hasActed, setHasActed] = useState(false);
  const [message, setMessage] = useState('');

  useEffect(() => {
    loadGameState();
    const socket = socketService.connect(roomId);
    
    socket.on('turn-started', (data) => {
      setHasMoved(false);
      setHasActed(false);
      if (data.playerId === playerId) {
        setMessage('ë‹¹ì‹ ì˜ í„´ì…ë‹ˆë‹¤!');
      }
      loadGameState();
    });
    
    socket.on('action-completed', (data) => {
      if (data.playerId === playerId) {
        setHasActed(true);
        if (data.result?.card) {
          setDrawnCard(data.result.card);
          setShowCardDrawModal(true);
        }
      }
      loadGameState();
    });
    
    socket.on('game-ended', () => {
      setShowResult(true);
    });
    
    return () => socketService.disconnect();
  }, [roomId, gameId, playerId]);

  const handleMove = async (position: number) => {
    await api.move(gameId, playerId, position);
    setHasMoved(true);
  };

  const handleAction = async (actionType: number) => {
    await api.performAction(gameId, playerId, actionType);
    setHasActed(true);
    
    // ìë™ í„´ ì¢…ë£Œ
    setTimeout(async () => {
      await api.endTurn(gameId, playerId);
    }, 2000);
  };

  return (
    <div className="game-screen">
      <div className="game-header">
        <h2>ğŸŒ™ ì—´ë„¤ ë°¤ì˜ ê¿ˆ</h2>
        <div>Day {gameState.day} / 14</div>
      </div>
      
      <div className="message-bar">{message}</div>
      
      <div className="game-content">
        <div className="left-panel">
          <PlayerInfo {...playerState} />
          <div className="other-players">
            {allPlayers.map(p => (
              <div key={p.id}>{p.nickname}</div>
            ))}
          </div>
        </div>
        
        <div className="center-panel">
          <GameBoard
            currentPosition={playerState?.position}
            onPositionClick={handleMove}
            disabled={!isMyTurn || hasMoved}
          />
          {isMyTurn && hasMoved && !hasActed && (
            <div className="action-buttons">
              {/* í–‰ë™ ë²„íŠ¼ë“¤ */}
            </div>
          )}
        </div>
        
        <div className="right-panel">
          <HandCards cards={playerState?.hand_cards || []} />
          <div className="joint-plan-section">
            {/* ê³µë™ ê³„íš */}
          </div>
          <ActionLog gameId={gameId} />
        </div>
      </div>
    </div>
  );
}
```

### 5. GameBoard.tsx (ê²Œì„ ë³´ë“œ)

**ê¸°ëŠ¥**:
- 6ì¹¸ ë³´ë“œ í‘œì‹œ
- í˜„ì¬ ìœ„ì¹˜ ê°•ì¡°
- ì¸ì ‘ ì¹¸ ê°•ì¡°
- í´ë¦­ ì´ë²¤íŠ¸

```typescript
function GameBoard({ currentPosition, onPositionClick, disabled }: Props) {
  const adjacentPositions = getAdjacentPositions(currentPosition);
  
  const positions = [
    { num: 1, name: 'ë¬´ë£Œ ê³„íš', icon: 'ğŸ' },
    { num: 2, name: 'ì¡°ì‚¬í•˜ê¸°', icon: 'ğŸ”' },
    { num: 3, name: 'ì§‘ì•ˆì¼', icon: 'ğŸ ' },
    { num: 4, name: 'ì—¬í–‰ ì§€ì›', icon: 'âœˆï¸' },
    { num: 5, name: 'ì°¬ìŠ¤', icon: 'ğŸ²' },
    { num: 6, name: 'ììœ  í–‰ë™', icon: 'â­' }
  ];

  return (
    <div className="game-board">
      {positions.map(pos => (
        <div
          key={pos.num}
          className={`board-cell ${
            pos.num === currentPosition ? 'current' : ''
          } ${
            adjacentPositions.includes(pos.num) && !disabled ? 'adjacent' : ''
          }`}
          onClick={() => !disabled && adjacentPositions.includes(pos.num) && onPositionClick(pos.num)}
        >
          <div className="cell-icon">{pos.icon}</div>
          <div className="cell-number">{pos.num}</div>
          <div className="cell-name">{pos.name}</div>
        </div>
      ))}
    </div>
  );
}
```

### 6. HandCards.tsx (ì†íŒ¨)

**ê¸°ëŠ¥**:
- ì†íŒ¨ ì¹´ë“œ ëª©ë¡ í‘œì‹œ
- ì¹´ë“œ í´ë¦­ ì‹œ ìƒì„¸ ì •ë³´ ëª¨ë‹¬

```typescript
function HandCards({ cards }: Props) {
  const [selectedCard, setSelectedCard] = useState<Card | null>(null);

  return (
    <>
      <div className="hand-cards">
        <h3>ë‚´ ì¹´ë“œ ({cards.length}ì¥)</h3>
        <div className="cards-list">
          {cards.map(card => (
            <div
              key={card.id}
              className="card-item"
              onClick={() => setSelectedCard(card)}
            >
              <div className="card-name">{card.name}</div>
              <div className="card-cost">{card.cost}TC</div>
              <div className="card-effects">
                {/* íš¨ê³¼ í‘œì‹œ */}
              </div>
            </div>
          ))}
        </div>
      </div>
      
      {selectedCard && (
        <div className="card-detail-modal">
          {/* ì¹´ë“œ ìƒì„¸ ì •ë³´ */}
        </div>
      )}
    </>
  );
}
```

### 7. ResultScreen.tsx (ê²°ê³¼ í™”ë©´)

**ê¸°ëŠ¥**:
- ìµœì¢… ìˆœìœ„ í‘œì‹œ
- ì ìˆ˜ ì„¸ë¶€ ë‚´ì—­
- ë‹¤ì‹œ í•˜ê¸° / ë¡œë¹„ë¡œ

```typescript
function ResultScreen({ gameId, roomId, playerId, onRestart, onBackToLobby }: Props) {
  const [results, setResults] = useState<GameResult[]>([]);

  useEffect(() => {
    loadResults();
  }, [gameId]);

  const handleResultClosed = async () => {
    const response = await api.recordResultClosed(gameId, playerId);
    if (response.data.allClosed) {
      // ëª¨ë“  í”Œë ˆì´ì–´ê°€ ê²°ê³¼ í™•ì¸ ì™„ë£Œ
    }
  };

  return (
    <div className="result-screen">
      <h2>ğŸ† ê²Œì„ ê²°ê³¼</h2>
      <div className="rankings">
        {results.map((result, index) => (
          <div key={result.playerId} className="rank-item">
            <div className="rank-number">{index + 1}ìœ„</div>
            <div className="player-name">{result.nickname}</div>
            <div className="total-score">{result.totalScore}ì </div>
            <div className="score-breakdown">
              {/* ì ìˆ˜ ì„¸ë¶€ ë‚´ì—­ */}
            </div>
          </div>
        ))}
      </div>
      <button onClick={onRestart}>ë‹¤ì‹œ í•˜ê¸°</button>
      <button onClick={onBackToLobby}>ë¡œë¹„ë¡œ</button>
    </div>
  );
}
```

## ì„œë¹„ìŠ¤

### api.ts (REST API)

```typescript
import axios from 'axios';

const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:4000/api';

const api = axios.create({
  baseURL: API_URL,
  headers: { 'Content-Type': 'application/json' }
});

export const apiService = {
  // ë°© ê´€ë¦¬
  createRoom: (nickname: string) => 
    api.post('/rooms', { nickname }),
  
  joinRoom: (code: string, nickname: string) => 
    api.post(`/rooms/${code}/join`, { nickname }),
  
  getRoom: (roomId: string) => 
    api.get(`/rooms/${roomId}`),
  
  startGame: (roomId: string) => 
    api.post(`/rooms/${roomId}/start`),
  
  // ê²Œì„ í”Œë ˆì´
  getGameState: (gameId: string) => 
    api.get(`/games/${gameId}/state`),
  
  move: (gameId: string, playerId: string, position: number) => 
    api.post(`/games/${gameId}/move`, { playerId, position }),
  
  performAction: (gameId: string, playerId: string, actionType: number) => 
    api.post(`/games/${gameId}/action`, { playerId, actionType }),
  
  endTurn: (gameId: string, playerId: string) => 
    api.post(`/games/${gameId}/end-turn`, { playerId }),
  
  contribute: (gameId: string, playerId: string, amount: number) => 
    api.post(`/games/${gameId}/contribute`, { playerId, amount }),
  
  // ìµœì¢… ì •ì‚°
  finalPurchase: (gameId: string, playerId: string, cardIds: string[]) => 
    api.post(`/games/${gameId}/final-purchase`, { playerId, cardIds }),
  
  finalize: (gameId: string) => 
    api.post(`/games/${gameId}/finalize`),
  
  recordResultClosed: (gameId: string, playerId: string) => 
    api.post(`/games/${gameId}/result-closed`, { playerId })
};
```

### socket.ts (WebSocket)

```typescript
import { io, Socket } from 'socket.io-client';

const SOCKET_URL = import.meta.env.VITE_SOCKET_URL || 'http://localhost:4000';

class SocketService {
  private socket: Socket | null = null;

  connect(roomId: string): Socket {
    if (!this.socket) {
      this.socket = io(SOCKET_URL, {
        transports: ['websocket', 'polling'],
        reconnection: true,
        reconnectionAttempts: 5,
        reconnectionDelay: 1000
      });
    }
    
    this.socket.emit('join-room', roomId);
    return this.socket;
  }

  disconnect() {
    if (this.socket) {
      this.socket.disconnect();
      this.socket = null;
    }
  }

  getSocket(): Socket | null {
    return this.socket;
  }
}

export const socketService = new SocketService();
```

## ìŠ¤íƒ€ì¼ë§

### CSS êµ¬ì¡°
- ê° ì»´í¬ë„ŒíŠ¸ë§ˆë‹¤ ë³„ë„ CSS íŒŒì¼
- CSS Variables ì‚¬ìš© (ìƒ‰ìƒ, ê°„ê²©)
- Flexbox/Grid ë ˆì´ì•„ì›ƒ
- ë°˜ì‘í˜• ë””ìì¸ (ëª¨ë°”ì¼ ëŒ€ì‘)

### ì£¼ìš” ìƒ‰ìƒ
```css
:root {
  --primary-color: #667eea;
  --secondary-color: #764ba2;
  --success-color: #48bb78;
  --danger-color: #f56565;
  --warning-color: #ed8936;
  --bg-color: #f7fafc;
  --text-color: #2d3748;
}
```

## í™˜ê²½ ë³€ìˆ˜

```env
# .env
VITE_API_URL=http://localhost:4000/api
VITE_SOCKET_URL=http://localhost:4000
```

## ë¹Œë“œ & ë°°í¬

### ë¡œì»¬ ê°œë°œ
```bash
npm run dev
```

### í”„ë¡œë•ì…˜ ë¹Œë“œ
```bash
npm run build
```

### Vercel ë°°í¬
- Build Command: `npm run build`
- Output Directory: `dist`
- Environment Variables: `VITE_API_URL`, `VITE_SOCKET_URL`
