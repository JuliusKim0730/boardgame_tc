# 2.00 게임 세팅/초기화 (Rule Setup)

## 목적
- 룰북 기준으로 덱 셔플, 여행지/공동 계획 공개, 초기 자원 지급, 선플레이어 결정.

## 입력/출력
- 입력: 방장 시작 요청.
- 출력: 초기화 완료 이벤트, 각 플레이어 `PlayerState`.

## 주요 처리
- 덱 6종 셔플: 계획/무료계획/집안일/여행지원/찬스/공동계획(+여행지).
- 여행지 1장 오픈, 공동 계획 1장 공개.
- 초기 자원: 돈 3,000TC, 위치 1, 계획 1 드로우, 결심 토큰 1.
- 선플레이어 결정 후 턴 순서 저장.
- **2인 전용**: 찬스 덱에서 CH11/CH12/CH13 제거, 2인 모드 플래그 설정.

## API/이벤트
- POST `/rooms/{roomId}/start` → 서버 내 `/games/{gameId}/setup`
- WS 이벤트: `game.setup.completed`

## 데이터/ERD 매핑
- `DECK`(order), `CARD` 로드, `PLAYERSTATE` 초기화, `GAME`의 여행지/공동계획 필드.

## 예외/동시성
- 플레이어 목록 스냅샷 후 일괄 초기화(트랜잭션).
- 중복 시작 방지.

## 복잡도
- 셔플 O(n) per deck, 드로우 O(1), 초기화 O(players + cards).

## 테스트
- 정상: 4인 기준 초기화 후 각 상태/덱 정상/여행지/공동계획 노출, 초기 자금 3,000TC 확인.
- 경계: 1인 시작 금지(최소 인원 검증 시), 2인 플레이 시 CH11/CH12/CH13 덱 제거 확인.
- 오류: 카드 리소스 누락 시 실패/롤백.

## MLOps 적용
- Job ID: `wf-2.00-setup`
- 목적: 세팅 서비스 단위 테스트/통합 테스트, 데이터 시드 검증.
- GitHub Actions 스니펫:
```yaml
name: wf-2.00-setup
on: [push]
jobs:
  test-seed:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with: { node-version: 20 }
      - run: npm ci
      - run: npm run test:setup -- --ci
```





