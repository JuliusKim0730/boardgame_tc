# 1.00 로비/방 관리 (Room Management)

## 목적
- 방 생성/참여/대기/시작을 통해 게임 세션을 준비한다.

## 입력/출력
- 입력: 닉네임, 방 코드(선택), 방장 시작 명령.
- 출력: 현재 참여자 목록, 방 상태(`waiting|in_progress`), 오류 사유.

## 상태 기계
- `waiting` →(방장 start)→ `in_progress`
- `in_progress` →(soft-reset)→ `waiting`

## 주요 API
- POST `/rooms` 방 생성
- POST `/rooms/{roomId}/join`
- GET  `/rooms/{roomId}` 상태 조회
- POST `/rooms/{roomId}/start` (2.00 세팅 트리거)
- WS `/ws/rooms/{roomId}` 참여자/상태 브로드캐스트

## 데이터/ERD 매핑
- `ROOM`, `GAME`(생성 시점), `PLAYER`, `PLAYERSTATE` 초기 레코드.

## 예외/동시성
- 동일 닉네임 충돌 시 suffix 부여.
- start 경쟁 시 1회만 허용(낙관락/분산락).

## 테스트
- 정상: 방 생성→2인 참여→시작→상태 `in_progress`.
- 경계: 동시 start 2건 중복 방지.
- 오류: 존재하지 않는 코드 join 시 404.

## 성능
- WS 연결 수 p95 안정, 참가/퇴장 브로드캐스트 지연 ≤ 300ms.

## MLOps 적용
- Job ID: `wf-1.00-room`
- 목적: 방 API/WS 헬스체크 및 e2e 연기 배포(Blue/Green).
- GitHub Actions 스니펫:
```yaml
name: wf-1.00-room
on: [push]
jobs:
  build-deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with: { node-version: 20 }
      - run: npm ci && npm run build
      - name: Containerize
        run: docker build -t bg01-webapp:${{ github.sha }} .
      - name: Push & Deploy
        run: |
          echo "push to registry && deploy to EKS with canary 10%"
```




